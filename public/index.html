<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proyecto Ángel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">

    <!-- 🔥 Agregado para SweetAlert (si quieres más adelante) -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script> -->

    <script>
        window.addEventListener("DOMContentLoaded", () => {
            const urlParams = new URLSearchParams(window.location.search);
            const exito = urlParams.get("exito");
            const mensaje = urlParams.get("mensaje");
            const authSection = document.getElementById("authSection");
            const mainSection = document.getElementById("mainSection");

            // Mostrar secciones según si hay éxito de login/registro
            if (exito || mensaje) {
                authSection.style.display = "none";
                mainSection.style.display = "block";
            } else {
                authSection.style.display = "block";
                mainSection.style.display = "none";
            }

            // Mostrar alert si viene un mensaje
            if (mensaje) {
                alert(decodeURIComponent(mensaje));
            }
        });
    </script>
</head>

<body class="min-vh-100">
    <div class="container text-center">

        <!-- 🔐 LOGIN Y REGISTRO -->
        <section id="authSection" style="display: none;">
            <h2 class="glitch">[🔐 Autenticación Requerida]</h2>
            <div class="row">
                <!-- Registro -->
                <div class="col-md-6">
                    <h4>Registro</h4>
                    <form action="/register" method="post">
                        <input type="text" name="username" placeholder="Usuario" class="form-control mb-2" required>
                        <input type="password" name="password" placeholder="Contraseña" class="form-control mb-2" required>

                        <!-- 🔥 Campo nuevo para clave secreta de Admin -->
                        <input type="text" name="admin_key" placeholder="Clave secreta de admin (opcional)" class="form-control mb-2">

                        <button class="btn btn-success w-100">Registrarse</button>
                    </form>
                </div>

                <!-- Login -->
                <div class="col-md-6">
                    <h4>Iniciar Sesión</h4>
                    <form action="/login" method="post">
                        <input type="text" name="username" placeholder="Usuario" class="form-control mb-2" required>
                        <input type="password" name="password" placeholder="Contraseña" class="form-control mb-2" required>
                        <button class="btn btn-primary w-100">Iniciar Sesión</button>
                    </form>
                </div>
            </div>
        </section>

        <!-- 🧪 CONTENIDO PRINCIPAL -->
        <section id="mainSection" style="display: none;">
            <h1 class="glitch">[🔴 ACCESO RESTRINGIDO]</h1>
            <p class="alert-hack">Advertencia: Información clasificada. Proceda con precaución.</p>
            <hr>

            <h2>📌 Registrar un Ángel</h2>
            <form action="/agregarAngel" method="post" class="mb-4">
                <input type="text" name="nombre" placeholder="Nombre del Ángel" class="form-control mb-2" required>
                <input type="text" name="codigo" placeholder="Código (Ej: A-013)" class="form-control mb-2" required>
                <select name="jerarquia" class="form-control mb-2" required>
                    <option value="">-- Jerarquía --</option>
                    <option value="Serafín">Serafín</option>
                    <option value="Querubín">Querubín</option>
                    <option value="Trono">Trono</option>
                    <option value="Dominación">Dominación</option>
                    <option value="Virtud">Virtud</option>
                    <option value="Potestad">Potestad</option>
                    <option value="Principado">Principado</option>
                    <option value="Arcángel">Arcángel</option>
                    <option value="Ángel">Ángel</option>
                </select>
                <input type="text" name="captura" placeholder="Cómo fue atrapado..." class="form-control mb-2" required>
                <select name="estado" class="form-control mb-3" required>
                    <option value="">-- Estado --</option>
                    <option value="Contenido">Contenido</option>
                    <option value="Neutralizado">Neutralizado</option>
                    <option value="En cuarentena">En cuarentena</option>
                    <option value="Desaparecido">Desaparecido</option>
                </select>
                <input type="submit" value="Registrar" class="btn btn-glitch w-100">
            </form>

            <hr>

            <h2>🧪 Registrar Experimento</h2>
            <form action="/agregarExperimento" method="post" class="mb-4">
                <input type="number" name="numero_experimento" placeholder="Número del Experimento" class="form-control mb-2" required>
                <select name="tipo_experimento" class="form-control mb-2" required>
                    <option value="">-- Tipo de Experimento --</option>
                    <option value="Resistencia">Resistencia</option>
                    <option value="Manipulación Mental">Manipulación Mental</option>
                    <option value="Interacción Física">Interacción Física</option>
                    <option value="Lenguaje Angélico">Lenguaje Angélico</option>
                    <option value="Otros">Otros</option>
                </select>
                <input type="text" name="descripcion" placeholder="Descripción del experimento" class="form-control mb-2" required>
                <input type="text" name="resultado" placeholder="Resultado del experimento" class="form-control mb-2" required>
                <input type="submit" value="Registrar" class="btn btn-glitch w-100">
            </form>

            <hr>

            <h2>📑 Lista de Ángeles Registrados</h2>
            <a href="/obtenerAngeles">
                <button class="btn btn-glitch w-100">Ver Ángeles Registrados</button>
            </a>

            <hr>

            <h2>📑 Lista de Todos los Experimentos</h2>
            <a href="/obtenerExperimentos">
                <button class="btn btn-glitch w-100">Ver Todos los Experimentos</button>
            </a>

            <hr>
            <a href="/logout"><button class="btn btn-danger w-100">Cerrar sesión</button></a>
        </section>
    </div>
</body>
</html>